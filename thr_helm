#!/bin/sh
#shortcut git status
#~zach

BASH_DIR=$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && pwd )

source $BASH_DIR/ks_config.sh
source $BASH_DIR/telhub.sh

if [ ! -d $MAIN_DIR ]; then
    mkdir $MAIN_DIR
fi

cd $CHARTS

helm_chart(){
    # if [ -f $1/values.yaml ]; then
    #     for file in $(ls $1/templates)
    #     do
    #         sed -i "s/$1/{{ .Values.serviceName }}/g" $1/templates/$file
    #     done
    # fi
    if [ ! -d $1 ]; then
        cp -r heartbeat-ps-adapter $1
        sed -i "s/heartbeat-ps-adapter/$1/g" $1/values.yaml
        sed -i "s/heartbeat-ps-adapter/$1/g" $1/Chart.yaml
    fi
}

if [ "$1" == "all" ]; then
    for s in "${SERVICE[@]}"
    do
        helm_chart $s
    done
else
    select s in "${SERVICE[@]}"
    do
        helm_chart $s
        exit
    done
fi
